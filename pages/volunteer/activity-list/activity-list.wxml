<view class="page activity-page">
  <view class="search-box card">
    <input class="search-input" placeholder="搜索活动名称或地点" confirm-type="search" value="{{keyword}}" bindinput="handleSearchInput" bindconfirm="handleSearchConfirm" />
    <button class="search-btn" size="mini" bindtap="handleSearchConfirm">搜索</button>
  </view>

  <view class="status-tabs card">
    <view wx:for="{{statusTabs}}" wx:key="value" class="tab {{activeStatus === item.value ? 'active' : ''}}" data-value="{{item.value}}" bindtap="changeStatus">
      {{item.label}}
    </view>
  </view>

  <block wx:if="{{activities.length}}">
    <view wx:for="{{activities}}" wx:key="id" class="activity-card card" data-id="{{item.id}}" data-activity="{{item.serialized}}" bindtap="goDetail">
      <view class="card-header">
        <view class="title">{{item.title}}</view>
        <view class="tag {{item.statusClass}}">{{item.statusText}}</view>
      </view>
      <view class="meta">
        <text>{{item.location || '地点待定'}}</text>
        <text class="dot">•</text>
        <text>{{item.timeRange}}</text>
      </view>
      <view class="progress">
        <view class="progress-bar" style="width: {{item.progress}}%;"></view>
      </view>
      <view class="progress-text">已报名 {{item.currentPeople}} / {{item.requiredPeople}}</view>
      <view class="card-footer">
        <view class="info">
          <text class="muted">负责人：{{item.leaderName || '待分配'}}</text>
        </view>
        <view class="actions">
          <button size="mini" class="ghost-btn" catchtap="goDetail" data-id="{{item.id}}" data-activity="{{item.serialized}}">详情</button>
          <button size="mini" type="primary" class="primary-btn" catchtap="handleSignup" data-id="{{item.id}}">报名</button>
        </view>
      </view>
    </view>
  </block>
  <view wx:else class="empty">暂无活动，稍后再来看看</view>

  <view wx:if="{{loading}}" class="loading">加载中...</view>
</view>
